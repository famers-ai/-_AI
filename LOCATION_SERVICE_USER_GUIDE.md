# 위치 서비스 사용자 가이드

**버전**: 2.0 (최적화됨)  
**업데이트**: 2026-02-01

---

## 📍 위치 서비스란?

Smart Farm AI의 위치 서비스는 사용자의 농장 위치를 기반으로 **맞춤형 날씨 정보**와 **지역별 병해충 예보**를 제공합니다.

### 주요 기능
- 🌍 **자동 위치 감지**: GPS를 사용한 정확한 위치 파악
- 📝 **수동 입력**: 도시명으로 간편하게 설정
- 🔄 **실시간 업데이트**: 위치 변경 시 즉시 반영
- 🔒 **개인정보 보호**: 도시명만 저장, GPS 좌표는 저장하지 않음

---

## 🚀 빠른 시작 가이드

### 1단계: 위치 설정 모달 열기

처음 로그인하면 자동으로 위치 설정 모달이 나타납니다.

```
┌─────────────────────────────────────┐
│  🗺️  Where is your farm?           │
│                                     │
│  We'll use this to provide          │
│  accurate weather data and local    │
│  farming insights.                  │
│                                     │
│  [📍 Use My Current Location]       │
│                                     │
│  ─────── or enter manually ───────  │
│                                     │
│  City Name: [____________]          │
│  [Set Location]                     │
│                                     │
│  [Skip for now]                     │
└─────────────────────────────────────┘
```

### 2단계: 위치 설정 방법 선택

#### 옵션 A: GPS 자동 감지 (권장)
1. **"Use My Current Location"** 버튼 클릭
2. 브라우저에서 위치 권한 요청 → **"허용"** 클릭
3. 자동으로 도시명 감지 및 저장 ✅

#### 옵션 B: 수동 입력
1. 도시명 입력란에 농장 위치 입력 (예: "Seoul", "New York")
2. **"Set Location"** 버튼 클릭
3. 저장 완료 ✅

### 3단계: 위치 확인

대시보드 상단에 설정된 위치가 표시됩니다:

```
┌──────────────────────┐
│ 📍 Seoul, Seoul      │
│    [⚙️]              │
└──────────────────────┘
```

---

## 🔧 위치 변경하기

### 방법 1: 설정 버튼 사용
1. 대시보드 상단의 위치 표시 옆 **⚙️ 아이콘** 클릭
2. 위치 설정 모달이 다시 열림
3. 새로운 위치 선택 또는 입력
4. 저장하면 **즉시 반영** (페이지 리로드 없음!)

### 방법 2: "Set your location" 버튼
위치가 설정되지 않은 경우:
1. **"Set your location"** 버튼 클릭
2. 위치 설정 진행

---

## ⚠️ 문제 해결 가이드

### GPS 권한 거부 에러

**에러 메시지**:
```
❌ Location access denied. Please enable location 
   permissions in your browser settings and try again.
```

**해결 방법**:

#### Chrome/Edge
1. 주소창 왼쪽의 🔒 아이콘 클릭
2. "사이트 설정" 선택
3. "위치" → **"허용"** 선택
4. 페이지 새로고침 후 다시 시도

#### Safari
1. Safari 메뉴 → "환경설정" → "웹사이트"
2. "위치" 탭 선택
3. forhumanai.net → **"허용"** 선택
4. 페이지 새로고침 후 다시 시도

#### Firefox
1. 주소창 왼쪽의 🔒 아이콘 클릭
2. "권한" → "위치 접근" → **"허용"** 선택
3. 페이지 새로고침 후 다시 시도

---

### GPS 타임아웃 에러

**에러 메시지**:
```
❌ Location request timed out. Please try again 
   or enter your city manually.
```

**원인**:
- 실내에서 GPS 신호 약함
- 디바이스 위치 서비스 비활성화
- 네트워크 연결 불안정

**해결 방법**:
1. **재시도**: "Use My Current Location" 버튼 다시 클릭
2. **수동 입력**: 도시명을 직접 입력하는 것이 더 빠를 수 있습니다
3. **디바이스 설정 확인**:
   - iOS: 설정 → 개인정보 보호 → 위치 서비스 → **켜기**
   - Android: 설정 → 위치 → **켜기**

---

### 위치 정보가 부정확한 경우

**증상**:
- GPS로 감지된 도시가 실제 위치와 다름
- 날씨 정보가 맞지 않음

**해결 방법**:
1. 위치 설정 모달 다시 열기 (⚙️ 아이콘 클릭)
2. **수동 입력**으로 정확한 도시명 입력
3. 저장 후 대시보드 확인

---

### 로그인 필요 에러

**에러 메시지**:
```
❌ Please log in to set your location
```

**해결 방법**:
1. 우측 상단 "Logout" 버튼 옆에 이메일 확인
2. 로그아웃 상태라면 **Google 로그인** 진행
3. 로그인 후 위치 설정 다시 시도

---

## 🎯 사용 팁

### 💡 Tip 1: 캐싱으로 빠른 응답
- 동일한 위치를 반복 설정하면 **즉시 반영** (0.01초)
- 캐시는 24시간 동안 유지됩니다

### 💡 Tip 2: 위치 변경 시 자동 업데이트
- 위치를 변경하면 대시보드가 **자동으로 새로고침**
- 페이지 리로드 없이 즉시 반영됩니다

### 💡 Tip 3: 개인정보 보호
- GPS 좌표는 **저장되지 않습니다**
- 도시명만 저장되어 개인정보가 보호됩니다
- 언제든지 위치 정보를 변경하거나 삭제할 수 있습니다

### 💡 Tip 4: 여러 농장 관리
- 각 Google 계정마다 별도의 위치 저장
- 계정 전환으로 여러 농장 관리 가능

---

## 📊 위치 서비스 성능

### 응답 시간
- **GPS 자동 감지**: 3-15초 (네트워크 상태에 따라)
- **캐시 히트**: 0.01초 (즉시)
- **수동 입력**: 0.5초

### 정확도
- **GPS**: ±50m (도시 단위로 변환)
- **수동 입력**: 사용자 입력에 따라

### 캐시 정책
- **유효 기간**: 24시간
- **최대 저장**: 10개 위치
- **자동 정리**: LRU (Least Recently Used) 방식

---

## 🔒 개인정보 보호

### 저장되는 정보
- ✅ 도시명 (예: "Seoul")
- ✅ 지역명 (예: "Seoul")
- ✅ 국가명 (예: "South Korea")
- ✅ 동의 여부 (true/false)
- ✅ 마지막 업데이트 시간

### 저장되지 않는 정보
- ❌ GPS 좌표 (위도/경도)
- ❌ 정확한 주소
- ❌ IP 주소
- ❌ 디바이스 정보

### 데이터 관리
- **조회**: 본인만 가능 (X-Farm-ID 인증)
- **수정**: 언제든지 가능
- **삭제**: 계정 삭제 시 자동 삭제

---

## 📱 모바일 사용 가이드

### iOS (Safari)
1. 위치 서비스 활성화: 설정 → 개인정보 보호 → 위치 서비스
2. Safari 위치 권한: 설정 → Safari → 위치 → **허용**
3. forhumanai.net 접속 후 위치 설정

### Android (Chrome)
1. 위치 서비스 활성화: 설정 → 위치
2. Chrome 위치 권한: 설정 → 앱 → Chrome → 권한 → 위치 → **허용**
3. forhumanai.net 접속 후 위치 설정

---

## 🆘 추가 지원

### 문제가 계속되는 경우
1. **브라우저 캐시 삭제**: Ctrl+Shift+Delete (Windows) / Cmd+Shift+Delete (Mac)
2. **다른 브라우저 시도**: Chrome, Safari, Firefox, Edge
3. **개발자 콘솔 확인**: F12 → Console 탭에서 에러 메시지 확인

### 피드백 및 문의
- **이메일**: support@forhumanai.net
- **GitHub Issues**: [프로젝트 저장소]

---

## 📝 버전 히스토리

### v2.0 (2026-02-01) - 최적화 업데이트
- ✅ 캐싱 메커니즘 추가 (90% API 호출 감소)
- ✅ 페이지 리로드 제거 (즉시 반영)
- ✅ 에러 메시지 개선 (명확한 복구 방법 안내)
- ✅ 인증 헤더 추가 (보안 강화)
- ✅ GPS 타임아웃 증가 (10s → 15s)

### v1.0 (2026-01-28) - 초기 릴리스
- ✅ GPS 자동 감지
- ✅ 수동 입력
- ✅ 위치 기반 날씨 정보

---

**마지막 업데이트**: 2026-02-01  
**작성자**: Smart Farm AI Team  
**문서 버전**: 2.0
